<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GraphQL Subscription Test</title>
</head>
<body>
  <h1>GraphQL Subscription Test</h1>
  <ul id="messages"></ul>

  <script type="module">
    // Import the createClient function from graphql-ws
    import { createClient } from 'https://cdn.jsdelivr.net/npm/graphql-ws/web/index.js';

    const ul = document.getElementById('messages');

    // Create a GraphQL WebSocket Client
    const client = createClient({
      url: 'ws://192.168.29.120:5000/graphql',
    });

    // Subscribe to the subscription
    const unsubscribe = client.subscribe(
      {
        query: `subscription { time }`,
      },
      {
        next: (data) => {
          const li = document.createElement('li');
          li.textContent = data.data.time;
          ul.appendChild(li);
        },
        error: (err) => {
          console.error(err);
        },
        complete: () => {
          console.log('Complete');
        },
      }
    );
  </script>
</body>
</html>
